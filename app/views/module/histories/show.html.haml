- content_for :title do
  Detil Riwayat Ujian - Dasbor

- content_for :content do
  - exam_session = @registration.exam_session
  - exam = exam_session.exam
  .max-w-4xl.mx-auto.w-full
    .my-8.text-3xl.font-black
      %a{ class:"p-1 bg-gray-400 rounded-full hover:bg-gray-600 hover:text-white text-3xl", href: index_module_history_path } 
        %i.ri-arrow-left-line
      %span.ml-2 #{exam.name}
    .p-6.bg-white.rounded-xl
      .divider.divider-start.uppercase.text-xl.font-black informasi peserta
      %table( class="w-full text-left border border-separate rounded border-slate-200" cellspacing="0" )
        %tbody
          %tr( class="transition-colors duration-300 hover:bg-slate-50" )
            %td( class="h-12 px-6 text-sm transition duration-300 border-t border-l first:border-l-0 border-slate-200 stroke-slate-500 text-slate-500 md:w-[200px] w-[100px]" ) Nama Peserta
            %td( class="h-12 px-6 text-sm transition duration-300 border-t border-l first:border-l-0 border-slate-200 stroke-slate-500 text-slate-500" )= current_user.user_detail.name
          
          %tr( class="transition-colors duration-300 hover:bg-slate-50" )
            %td( class="h-12 px-6 text-sm transition duration-300 border-t border-l first:border-l-0 border-slate-200 stroke-slate-500 text-slate-500" ) Pangkat/NRP
            %td( class="h-12 px-6 text-sm transition duration-300 border-t border-l first:border-l-0 border-slate-200 stroke-slate-500 text-slate-500" )#{current_user.user_detail.rank}/#{current_user.identity}
          
          - if @registration.golongan.present?
            %tr( class="transition-colors duration-300 hover:bg-slate-50" )
              %td( class="h-12 px-6 text-sm transition duration-300 border-t border-l first:border-l-0 border-slate-200 stroke-slate-500 text-slate-500" ) Golongan Saat Ujian
              %td( class="h-12 px-6 text-sm transition duration-300 border-t border-l first:border-l-0 border-slate-200 stroke-slate-500 text-slate-500" )
                %span.badge.badge-lg{ class: @registration.golongan == 4 ? 'badge-error' : (@registration.golongan == 3 ? 'badge-warning' : (@registration.golongan == 2 ? 'badge-info' : 'badge-success')) }
                  Golongan #{@registration.golongan}
      
      .divider.divider-start.uppercase.text-xl.font-black detil ujian
      %p.mb-4.text-sm Mohon untuk dapat hadir pada hari ujian dan datang sebelum waktu yang ditentukan atau mengikuti informasi lanjut ujian.

      %table( class="w-full text-left border border-separate rounded border-slate-200" cellspacing="0" )
        %tbody
          %tr( class="transition-colors duration-300 hover:bg-slate-50" )
            %td( class="h-12 px-6 text-sm transition duration-300 border-t border-l first:border-l-0 border-slate-200 stroke-slate-500 text-slate-500 md:w-[200px] w-[100px]" ) Tanggal Ujian
            %td( class="h-12 px-6 text-sm transition duration-300 border-t border-l first:border-l-0 border-slate-200 stroke-slate-500 text-slate-500" )= I18n.l(exam_session.start_time, format: :date_only)
          
          %tr( class="transition-colors duration-300 hover:bg-slate-50" )
            %td( class="h-12 px-6 text-sm transition duration-300 border-t border-l first:border-l-0 border-slate-200 stroke-slate-500 text-slate-500" ) Waktu Ujian
            %td( class="h-12 px-6 text-sm transition duration-300 border-t border-l first:border-l-0 border-slate-200 stroke-slate-500 text-slate-500" ) #{I18n.l(exam_session.start_time, format: :time_only)} - #{I18n.l(exam_session.end_time, format: :time_only)} WIB
          
          %tr( class="transition-colors duration-300 hover:bg-slate-50" )
            %td( class="h-12 px-6 text-sm transition duration-300 border-t border-l first:border-l-0 border-slate-200 stroke-slate-500 text-slate-500 text-center" colspan="2" ) Informasi Lanjut Ujian
          %tr( class="transition-colors duration-300 hover:bg-slate-50" )
            %td( class="h-12 px-6 text-sm transition duration-300 border-t border-l first:border-l-0 border-slate-200 stroke-slate-500 text-slate-500" colspan="2" )
              - if !exam.descriptions.empty?
                .whitespace-pre-line.mb-4
                  #{exam.descriptions}
              - else
                .divider.italic.uppercase.text-sm.text-gray-500.font-bold tidak ada informasi lanjutan

          %tr( class="transition-colors duration-300 hover:bg-slate-50" )
            %td( class="h-12 px-6 text-sm transition duration-300 border-t border-l first:border-l-0 border-slate-200 stroke-slate-500 text-slate-500" ) Nilai Ujian
            %td( class="h-12 px-6 text-sm transition duration-300 border-t border-l first:border-l-0 border-slate-200 stroke-slate-500 text-slate-500" )
              - score_grade = @registration.score&.score_grade
              - score_number = @registration.score&.score_number
              - if score_grade.present? && score_number.present?
                .flex.flex-col.md:flex-row.md:items-center.md:justify-between.gap-4
                  .flex.items-center.gap-2.text-gray-800
                    %span.font-semibold= score_grade
                    %span.text-sm.text-gray-500.mr-2= "(#{score_number})"

                  -# Temporarily hidden - print result buttons
                  -# - if @registration.score.result_report_status == "completed"
                  -#   .flex.flex-wrap.gap-2
                  -#     = link_to result_report_slug_path(@registration.score.result_report_slug),
                  -#       class: "inline-flex items-center px-4 py-2 rounded-xl bg-green-600 text-white hover:bg-green-700 shadow-sm transition", target: "_blank" do
                  -#       %i.ri-file-line.mr-2
                  -#       Lihat Hasil
                  -#
                  -#     = button_to generate_result_report_path(@registration.score.slug),
                  -#       method: :post,
                  -#       class: "inline-flex items-center px-4 py-2 rounded-xl bg-red-500 text-white hover:bg-red-600 shadow-sm transition" do
                  -#       %i.ri-printer-line.mr-2
                  -#       Cetak Ulang
                  -# - else
                  -#   = button_to generate_result_report_path(@registration.score.slug),
                  -#     method: :post,
                  -#     class: "inline-flex items-center px-4 py-2 rounded-xl bg-red-500 text-white hover:bg-red-600 shadow-sm transition" do
                  -#     %i.ri-printer-line.mr-2
                  -#     Cetak Hasil
              - else
                %span.text-yellow-700.font-medium Nilai belum diinput
      
      .divider.divider-start.uppercase.text-xl.font-black.text-red-600 detil pendaftaran
      .bg-red-500.p-2.mb-4.text-sm.text-white.font-semibold 
        %p Catatan: Berkas pendaftaran mohon untuk dicetak dan dibawa saat ujian berlangsung.
        %p Cetak keseluruhan berkas. Gunakan kertas ukuran Legal, perhatikan dalam mencetak berkas, pastikan tidak ada kata atau tulisan yang terpotong hingga bawah.
      %table( class="w-full text-left border border-separate rounded border-red-600" cellspacing="0" )
        %tbody
          %tr( class="transition-colors duration-300 hover:bg-slate-50" )
            %td( class="h-12 px-6 text-sm transition duration-300 border-t border-l first:border-l-0 border-red-500 stroke-slate-500 text-slate-500 md:w-[200px] w-[100px]" ) Waktu Daftar
            %td( class="h-12 px-6 text-sm transition duration-300 border-t border-l first:border-l-0 border-red-500 stroke-slate-500 text-slate-500" )= I18n.l(@registration.created_at, format: :full_wib)
          %tr( class="transition-colors duration-300 bg-indigo-300 hover:bg-indigo-400" )
            %td( class="h-12 px-6 text-sm transition duration-300 border-t border-l first:border-l-0 border-red-500 stroke-slate-500 text-slate-500 md:w-[200px] w-[100px]" ) Berkas Pendaftaran
            %td( class="h-12 px-6 text-sm transition duration-300 border-t border-l first:border-l-0 border-red-500 stroke-slate-500 text-slate-500" )
              - if @registration.completed?
                %a.btn.bg-green-600.text-white.my-2{ class:"hover:bg-green-700", href: download_pdf_module_history_path(@registration.slug), target: "_blank" }
                  %i.ri-download-2-line
                  .text-xs Unduh Berkas
              - else
                %a.btn.bg-green-600.text-white.my-2{ class:"hover:bg-green-700", href: download_pdf_module_history_path(@registration.slug), target: "_blank" }
                  %i.ri-download-2-line
                  .text-xs Unduh Berkas

= render "layouts/dashboard"
