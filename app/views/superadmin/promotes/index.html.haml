- content_for :title do
  Kelola Operator - Dasbor

- content_for :content do
  .mobile-message
    .mt-8.bg-yellow-100.border-l-4.border-yellow-500.text-yellow-700.p-4
      %p.font-bold Maaf, laman ini tidak bisa diakses dengan ponsel.
  .desktop-content
    .divider.divider-start.uppercase.text-gray-400.font-bold daftar superadmin
    .text-sm.text-gray-500.italic.mb-2
      %p Superadmin dibatasi untuk 3 pengguna
      
    %p.font-bold Jumlah Superadmin: #{@superadmin_count} dari 3
    %ul.list-disc.list-inside.text-sm
      - @superadmins.each do |user|
        %li
          = "#{user.user_detail.name} (#{user.identity})"

    .divider.divider-start.uppercase.text-gray-400.font-bold daftar operator
    .text-sm 
      %i.ri-information-line.text-xl
      %span.text-gray-500.italic Dikarenakan data terenkripsi pada tingkat database maka tidak bisa pencarian secara fuzzy/parsial, mohon masukkan keseluruhan nomor NRP/NIP.
    .mt-4 
      %input#filter-value.input{ type: "text", placeholder: "Masukkan NRP/NIP" }
      %button#filter-search.btn.btn-accent Cari
      %button#filter-clear.btn.btn-error Muat ulang
    .mt-8#data

= render "layouts/dashboard"

:javascript
  // Tanulator table
  var table = new Tabulator("#data",{
    minHeight: 300,
    pagination: true,
    paginationMode: "remote",
    filterMode: "remote",
    ajaxURL: "/superadmin/kelola/operator/data",
    paginationSize: 10,
    paginationSizeSelector: [10, 25, 50],
    layout: "fitDataFill",
    rowHeader: {
      formatter: "rownum",
      headerSort: false,
      hozAlign: "center",
      vertAlign: "middle",
      resizable: false,
      frozen: true
    },
    columns:[
      { title: "NRP/NIP", field: "identity", width: 180, resizable: false, headerSort: false, vertAlign: "middle" },
      { title: "Nama", field: "name", width: 250, headerSort: false, vertAlign:"middle" },
      { title: "Waktu Daftar", field: "created_at", width: 250, headerSort: false, vertAlign: "middle"},
      { 
        title: "Aksi" ,
        width: 200,
        hozAlign: "center", 
        headerHozAlign: "center", 
        vertAlign: "middle",
        headerSort: false,
        formatter: (cell, formatterParams, onRendered) => {
          let showButton = document.createElement("a")
          showButton.className =  "btn btn-sm rounded-lg btn-error uppercase text-white text-xs"
          showButton.innerHTML = "<i class=ri-corner-left-down-line></i>hapus"
          showButton.href = "/superadmin/kelola/operator/hapus/" + cell.getRow().getData().slug

          let container = document.createElement("div")
          container.className = "flex space-x-2"
          container.appendChild(showButton)

          return container          
        }
      }
    ]
  })

  function updateFilter() {
    let search_param = document.getElementById("filter-value").value.trim()

    if(search_param) {
      table.setFilter("identity", "=", search_param)
    }
  }



  document.getElementById("filter-search").addEventListener("click", updateFilter)

  document.getElementById("filter-clear").addEventListener("click", () => { window.location.reload() });



